import{a as i,p as e,w as P}from"./chunk-EF7DTUVF-2iiA7sVW.js";function W({src:k,className:b,masks:M,onMasksChange:y,hoveredMaskId:g}){const[D,C]=i.useState([]),[r,N]=i.useState(!1),[h,S]=i.useState(null),[c,u]=i.useState(null),[f,v]=i.useState(!1),s=i.useRef(null),n=M||D,l=y||C,d=i.useCallback(a=>{if(!s.current)return{x:0,y:0};const t=s.current.getBoundingClientRect();if("touches"in a){const o=a.touches[0]||a.changedTouches[0];return{x:o.clientX-t.left,y:o.clientY-t.top}}else return{x:a.clientX-t.left,y:a.clientY-t.top}},[]),p=i.useCallback(a=>{a.preventDefault();const t=d(a);N(!0),v(!1),S(t),u({id:Date.now().toString(),x:t.x,y:t.y,width:0,height:0})},[d]),x=i.useCallback(a=>{if(!r||!h)return;a.preventDefault();const t=d(a),o=t.x-h.x,m=t.y-h.y;!f&&(Math.abs(o)>5||Math.abs(m)>5)&&v(!0),u(w=>w?{...w,width:Math.abs(o),height:Math.abs(m),x:o<0?t.x:h.x,y:m<0?t.y:h.y}:null)},[r,h,f,d]),I=i.useCallback(()=>{c&&c.width>10&&c.height>10&&typeof l=="function"&&l(a=>[...a,c]),N(!1),S(null),u(null),setTimeout(()=>v(!1),0)},[c,l]),E=i.useCallback((a,t)=>{t.stopPropagation(),!(r||f)&&typeof l=="function"&&l(o=>o.filter(m=>m.id!==a))},[r,f,l]),F=i.useCallback(async()=>{if(!s.current)return;const a=s.current.querySelector("img");if(a)try{const t=new Image;t.crossOrigin="anonymous",await new Promise((j,T)=>{t.onload=()=>j(),t.onerror=()=>T(new Error("이미지 로드 실패")),t.src=k});const o=document.createElement("canvas"),m=o.getContext("2d");if(!m)return;o.width=t.naturalWidth,o.height=t.naturalHeight,m.drawImage(t,0,0);const w=t.naturalWidth/a.offsetWidth,R=t.naturalHeight/a.offsetHeight;m.fillStyle="black",n.forEach(j=>{m.fillRect(j.x*w,j.y*R,j.width*w,j.height*R)});const L=document.createElement("a");L.download="masked-image.png",L.href=o.toDataURL(),L.click()}catch(t){console.error("이미지 다운로드 중 오류 발생:",t),alert("이미지 다운로드에 실패했습니다. CORS 정책으로 인해 외부 이미지는 다운로드할 수 없을 수 있습니다.")}},[n,k]),H=i.useCallback(()=>{typeof l=="function"&&l([])},[l]);return e.jsxs("div",{className:`image-masking-container ${b||""}`,children:[e.jsxs("div",{className:"image-masking-controls",children:[e.jsx("button",{onClick:H,disabled:n.length===0,className:"image-masking-button image-masking-button-clear",children:"모든 마스크 제거"}),e.jsx("button",{onClick:F,disabled:n.length===0,className:"image-masking-button image-masking-button-export",children:"이미지 다운로드"}),e.jsxs("span",{className:"image-masking-counter",children:["마스크 개수: ",n.length]})]}),e.jsxs("div",{ref:s,className:"image-masking-image-container",onMouseDown:p,onMouseMove:x,onMouseUp:I,onMouseLeave:I,onTouchStart:p,onTouchMove:x,onTouchEnd:I,onTouchCancel:I,children:[e.jsx("img",{src:k,alt:"마스킹할 이미지",className:"image-masking-image",draggable:!1,crossOrigin:"anonymous"}),n.map(a=>e.jsx("div",{className:`image-masking-mask ${g===a.id?"image-masking-mask-hovered":""}`,style:{left:a.x,top:a.y,width:a.width,height:a.height},onClick:t=>E(a.id,t),onTouchEnd:t=>E(a.id,t),title:"클릭하여 삭제"},a.id)),c&&e.jsx("div",{className:"image-masking-current-mask",style:{left:c.x,top:c.y,width:c.width,height:c.height}})]}),e.jsxs("div",{className:"image-masking-instructions",children:[e.jsx("p",{className:"image-masking-instructions-title",children:"사용법:"}),e.jsxs("ul",{className:"image-masking-instructions-list",children:[e.jsx("li",{className:"image-masking-instructions-item",children:"이미지에서 마우스를 클릭하고 드래그하거나 터치하고 드래그하여 마스크 영역을 선택하세요"}),e.jsx("li",{className:"image-masking-instructions-item",children:"생성된 검은 마스크를 클릭하면 삭제됩니다"}),e.jsx("li",{className:"image-masking-instructions-item",children:"마스크가 적용된 이미지를 다운로드할 수 있습니다"})]})]})]})}const Y=P(function(){const[b,M]=i.useState(null),[y,g]=i.useState([]),[D,C]=i.useState(null),[r,N]=i.useState({x:"",y:"",width:"",height:""}),h=s=>{var l;const n=(l=s.target.files)==null?void 0:l[0];if(n){const d=new FileReader;d.onload=p=>{var x;M((x=p.target)==null?void 0:x.result),g([])},d.readAsDataURL(n)}},S=s=>{M(s),g([])},c=s=>{g(n=>n.filter(l=>l.id!==s))},u=(s,n)=>{N(l=>({...l,[s]:n}))},f=()=>{const s=parseFloat(r.x),n=parseFloat(r.y),l=parseFloat(r.width),d=parseFloat(r.height);if(isNaN(s)||isNaN(n)||isNaN(l)||isNaN(d)){alert("모든 필드에 유효한 숫자를 입력해주세요.");return}if(l<=0||d<=0){alert("너비와 높이는 0보다 커야 합니다.");return}if(s<0||n<0){alert("X, Y 좌표는 0 이상이어야 합니다.");return}const p={id:Date.now().toString(),x:s,y:n,width:l,height:d};g(x=>[...x,p]),N({x:"",y:"",width:"",height:""})},v=["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&h=600&fit=crop","https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&h=600&fit=crop"];return e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"이미지 마스킹 데모"}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"이미지에 검은 직사각형 마스크를 추가하여 특정 영역을 가릴 수 있습니다. 이미지를 업로드하거나 샘플 이미지를 선택해보세요."})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"이미지 선택"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"이미지 업로드"}),e.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"또는 샘플 이미지 선택"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:v.map((s,n)=>e.jsx("div",{className:`cursor-pointer border-2 rounded-lg overflow-hidden transition-all ${b===s?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"}`,onClick:()=>S(s),children:e.jsx("img",{src:s,alt:`샘플 이미지 ${n+1}`,className:"w-full h-32 object-cover"})},n))})]})]}),b&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"이미지 마스킹"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"이미지를 클릭하고 드래그하여 마스크를 추가하세요. 마스크를 클릭하면 삭제할 수 있습니다."}),e.jsx(W,{src:b,masks:y,onMasksChange:g,hoveredMaskId:D})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"마스크 관리"}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"좌표로 마스크 추가"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"X 좌표"}),e.jsx("input",{type:"number",value:r.x,onChange:s=>u("x",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Y 좌표"}),e.jsx("input",{type:"number",value:r.y,onChange:s=>u("y",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"너비"}),e.jsx("input",{type:"number",value:r.width,onChange:s=>u("width",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"100",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"높이"}),e.jsx("input",{type:"number",value:r.height,onChange:s=>u("height",s.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"100",min:"1"})]})]}),e.jsx("button",{onClick:f,className:"w-full px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded hover:bg-blue-700 transition-colors",children:"마스크 추가"})]}),e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"마스크 목록"}),y.length===0?e.jsxs("p",{className:"text-gray-500 text-center py-8",children:["아직 마스크가 없습니다.",e.jsx("br",{}),"이미지에 마스크를 추가해보세요."]}):e.jsxs("div",{className:"space-y-2",children:[y.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onMouseEnter:()=>C(s.id),onMouseLeave:()=>C(null),onClick:()=>c(s.id),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:["마스크 #",n+1]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["위치: (",Math.round(s.x),", ",Math.round(s.y),")"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["크기: ",Math.round(s.width)," × ",Math.round(s.height)]})]}),e.jsx("div",{className:"ml-3",children:e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},s.id)),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["💡 ",e.jsx("strong",{children:"팁:"})," 마스크에 마우스를 올리면 이미지에서 해당 마스크가 강조됩니다. 클릭하면 삭제됩니다."]})})]})]})]}),!b&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-16 w-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("p",{className:"text-lg text-gray-500",children:"위에서 이미지를 선택하면 마스킹 도구가 나타납니다"})]})]})]})})});export{Y as default};
